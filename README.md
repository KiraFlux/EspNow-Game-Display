# Правила игры ESP-NOW

## I. Участники

1. **Сервер (Хост)**
    - Компьютер с подключённым ESP32
    - Функции:
        - Ручное управление командами (название/цвет/состав)
        - Отображение игрового поля
        - Приём и обработка ходов
        - Контроль игрового процесса

2. **Клиенты (Игроки)**
    - Участники с пультами на базе ESP32
    - Функции:
        - Отправка имени
        - Отправка координат клеток
        - Получение статуса ходов

## II. Игровые элементы

1. **Поле**
    - Сетка размером `X` (ширина) * `Y` (высота) клеток
    - Система координат:
        - Левый верхний угол: (1, 1)
        - Правый нижний угол: (`X`, `Y`)

2. **Клетка**
    - Статусы:
        - `Свободна`: Доступна для захвата
        - `Занята`: Принадлежит команде (цвет)

3. **Команды**
    - Группы игроков, создаваемые хостом
    - Атрибуты: название, цвет, состав

## III. Игровой процесс

1. **Инициализация**
    - Хост назначает игроков в команды
    - Рассылает параметры: размер поля (`X`/`Y`), цель (`N`)

2. **Начало игры**
    - Хост отправляет сигнал разрешения ходов
    - Без сигнала ходы игроков игнорируются

3. **Механика хода**
    - Условия для принятия хода:
        - Клетка в диапазоне (1..`X`, 1..`Y`)
        - Клетка свободна
        - Соблюдён минимальный интервал между ходами игрока
    - Процесс:
        1. Игрок выбирает клетку
        2. Пульт отправляет координаты через ESP-NOW

4. **Обработка хода**
    - Успех:
        - Клетка переходит к команде игрока
        - Начисление очков игроку
    - Ошибка (ответ сервера):
        - `Клетка занята`
        - `Неверные координаты`
        - `Подождите ещё T секунд`

## IV. Условия победы

1. **Цель**
    - Построить непрерывную линию из N клеток команды:
        - Горизонтальную
        - Вертикальную
        - Диагональную

2. **Завершение игры**
    - Немедленно после построения линии
    - Победитель: команда, построившая линию

3. **Определение лидеров**
    - Топ игроков победившей команды
    - Критерий: максимальное количество очков

## V. Дополнительные правила

1. **Динамические изменения**
    - При смене размера поля (X/Y) хост рассылает обновления

2. **Тайминги**
    - Минимальный интервал между ходами одного игрока устанавливается хостом

## Ключевые определения

- **Сигнал начала**: Сообщение хоста, разрешающее отправку ходов
- **Минимальный интервал**: Фиксированная пауза (секунды) между ходами игрока
- **Линия**: N смежных клеток одной команды по прямой
- **Статус хода**: Ответ сервера (успех/причина ошибки)  